Gordon Brown today announced that emergency legislation on the use of anonymous witnesses in criminal cases would be rushed through parliament next week.The move follows the collapse of an Old Bailey murder trial and a warning from police that dozens of other prosecutions might now be in jeopardy.The prime minister told MPs during Commons question time that he hoped to gain cross-party support for the measures that will be brought forward next week to rescue pending trials, including more than three terrorism cases, one of which is due to start in the autumn.Police said yesterday there are 40 to 50 cases either going through the courts, or about to start, that could be affected by last week's Law Lords ruling. The ruling stated defendants have a right to know the identity of the witness giving evidence against them if the testimony is decisive.The Crown Prosecution Service yesterday sought an adjournment in all cases using anonymous witnesses so the implications of the judgment can be assessed. Scores of defendants convicted on anonymous evidence may also appeal.The justice secretary, Jack Straw, was trying to reach agreement over a way forward with the Conservatives and Liberal Democrats. Any immediate moves might be resisted in the House of Lords because of concerns over civil liberties, and anxiety that any new legislation will be rushed.The intense political activity was sparked when the Â£6m trial of two men for the murder of businessman Charles Butler, 50, was halted at the Old Bailey. Defendants Douglas Johnson and David Austin are likely to face a retrial next year.The decision to stop the proceedings came as a direct result of the ruling last Wednesday in the case of Iain Davis, who was convicted of a double murder at the Old Bailey in 2004. The five law lords said he was denied a fair trial because the identities of three witnesses who named him as the gunman were concealed. Witnesses gave evidence from behind a screen, their voices were distorted, and lawyers were banned from asking any questions that would reveal their identities.The judges said English common law and European human rights law require that a defendant be able to confront his accusers and cross examine them properly. Lord Bingham, the senior law lord, said Davis's counsel was required "to take blind shots at a hidden target," adding: "A trial so conducted cannot be regarded as meeting ordinary standards of fairness."Police and prosecutors have increasingly resorted to promising anonymity in recent years to persuade frightened witnesses to testify. The device has been successful in tackling gun crime, say police.The law lords acknowledged the public interest in bringing dangerous offenders to justice, but said it was for parliament, not judges, to deal with the problem.Any new legislation will have to comply with the right to a fair trial guaranteed by the Human Rights Act. Finding a model which achieves this will not be easy.Ken Jones, president of the Association of Chief Police Officers, said yesterday the damage caused by last week's ruling could be wider than feared. "It could stifle current investigations. This isn't an esoteric legal point, it effects real people."He said that witnesses in past cases will also need to be reassured if appeals are lodged. "In an appeal, there is a possibility of anonymity being challenged by defence lawyers. We have made promises to people and are determined to keep them."The home secretary, Jacqui Smith, said she saw no obstacles to fixing the issue, and Edward Garnier, the shadow justice minister said the Tories would work with the government. "We clearly need to ensure fairness in all trials both for defendant and prosecution," he said. "But we are all acutely aware of the issues around gangland crime, intimidation of witnesses and so on. We will approach this difficult question constructively."