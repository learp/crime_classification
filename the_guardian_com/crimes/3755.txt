Gary McKinnon, the British hacker who embarrassed the Pentagon and Nasa by entering their computer systems from a flat in north London, has lost his long battle against extradition. Yesterday it was announced that he has been unsuccessful in his appeal to the European court of human rights and must now submit himself for trial in the US.This is more than just depressing news for McKinnon, a genial soul who is guilty of having an insatiable curiosity and a mischievous nature but certainly not of threatening the security of the US, as its prosecuting authorities have speciously suggested. It is also depressing news for people who believe that the courts of this country have a duty to protect their citizens' rights.By a remarkable coincidence, McKinnon's case is back in the news at the same time as that of Binyam Mohamed, the British citizen currently held in Guant√°namo Bay, where he was taken in 2004 after, he claims, having been tortured in Morocco and Afghanistan into making confessions. Over the past 10 days, the high court in London has been hearing evidence about the secrecy that has surrounded the rendition of Mohamed, the suggestion that he was tortured by having his penis cut with a razorblade and the fact that the US authorities have been unwilling to surrender the details of his confinement to the lawyers who are attempting to defend him, when he is eventually granted a trial, more than six years after he was arrested.No one is suggesting McKinnon is in line for such treatment, although the fact that one member of the prosecuting team in the US has admitted he would like to "see him fry" hardly encourages hopes of a fair and rational trial in the US.When the law lords brushed aside McKinnon's appeal to them recently, they declared that "the difference between the American system and our own is not perhaps so stark as the appellant's argument suggests". But they delivered their judgment before the high court heard about the disturbing behaviour of the US prosecutorial process in the case of Mohamed. What the Mohamed case has shown is that, when it comes to cases of supposed national security, all bets are off. McKinnon is not trying to dodge responsibility for his action. Both he and his lawyers have always indicated that he is prepared to stand trial in this country, where the alleged offence was committed. That offer was repeated again yesterday, alongside the information that McKinnon has been diagnosed as suffering from Asperger's syndrome. The home secretary, Jacqui Smith, has now been invited to initiate a prosecution here which would remove the necessity for McKinnon to be deported to the US. This must be the sanest solution.In the Mohamed case this week, the US state department warned the UK of "serious and lasting damage to the US-UK intelligence-sharing relationship" if details of his interrogation and incarceration were disclosed to his lawyers. It is time to assert the rights of citizens to enjoy a fair trial, free from bogus security innuendo, and maybe for the Home Office to warn of the potential "serious and lasting damage" to the relationship by the US's pursuit of a harmless hacker. The only significant part of the US defence establishment to have suffered any damage as a result of McKinnon's intrusions has been its ego, which has admittedly received a bruising since he deposited the suggestion that its security system was "crap", nearly a decade ago. The UK government has been accused of failure to punch its weight on the international stage. What a wonderful opportunity Jacqui Smith now has to argue McKinnon's case to stand trial here and to show that, in any relationship, it takes two to tango, whatever tune the military band may be playing.duncan.campbell@theguardian.com