Scotland Yard's deputy commissioner was told two months ago of allegations that his officers had bugged an MP while he talked to a constituent who was held in prison, the Guardian has learned.Paul Stephenson was passed details of the allegations concerning the Labour MP Sadiq Khan and Babar Ahmad, who is in jail awaiting extradition to the United States for alleged terrorism offences.Stephenson is deputy to Metropolitan police commissioner Sir Ian Blair, and opposition politicians have demanded to know what the force's most senior officers knew about the bugging and when.Last night the shadow home secretary, David Davis, said Stephenson must have known that the bugging was likely to contravene the spirit of the Wilson doctrine, which protects MPs from surveillance. He said: "It raises very serious questions about the authorisation procedure and about why the Metropolitan police did not inform the home secretary, to whom they are directly accountable, and the justice secretary, to whom Mr Khan worked."It is just about understandable that a middle-ranking police officer involved in the taping operation was not aware of the Wilson doctrine. It is not remotely possible that the commissioner and deputy commissioner will be unaware of their duties under that doctrine."The Met bugged the MP on two occasions in May 2005 and June 2006 at Woodhill prison, near Milton Keynes. Khan is now a government whip attached to the Ministry of Justice. Whitehall sources add that some government officials are annoyed and surprised that the Met has been slow to provide an accurate account of what happened. Those with knowledge of the force say some Scotland Yard senior officers do not understand the extent of the fuss that greeted the revelations that their anti-terrorism officers bugged an MP, which may contravene the Wilson doctrine prohibiting the bugging of politicians.On Monday, the justice secretary, Jack Straw, told the Commons that the first he knew of the allegations was when they were published in a Sunday newspaper last weekend. On Wednesday he had to admit that he had been told of meetings between Khan and Ahmad, but not of the allegation that their conversations were bugged by Scotland Yard.Conversations between Ahmad and those visiting him in jail were bugged between 2004 and 2006. In private Scotland Yard says the discussions with Khan were not specifically targeted by police, but were caught by accident.Straw has announced an inquiry into the allegations, to be headed by a former judge.Two sources say an operation monitoring Ahmad began after his arrest and imprisonment following the US extradition request in 2004 and continued until at least summer 2006. A visiting document would have been submitted before the visits in May 2005 and June 2006, and sources say it was not clearly stated that Khan was an MP. The bugging, using a device under a table, was carried out by Thames Valley police. But it was requested by Scotland Yard's anti-terrorism branch, which had originally made the arrest Ahmad was suing over.Sources with knowledge of covert surveillance have expressed surprise that Ahmad was bugged by the police for a three-year period when no criminal case was being pursued against him. He was arrested in December 2003 by the Met on terrorism allegations, but released after six days. In August 2004 he was detained on a US extradition warrant. One police source with experience of ordering covert surveillance said few in the service would have heard of the Wilson doctrine.