A judge today warned the singer Pete Doherty he faced certain jail if he failed to stay on a detox programme or was caught with drugs again.District judge Davinder Lachhar issued an arrest warrant for Doherty shortly before the Babyshambles frontman arrived, two and a half hours late, at a court hearing to face drug possession charges. And she made it clear she had little patience with his efforts to beat addiction.The judge deferred sentencing in today's case until August 7 on condition that the 28-year-old entered another detox programme and committed no more offences."If you go to this place to have detox and take advantage of it, then we will see what sentence is appropriate when you next come. But if you do not, I can tell you now that you will go into custody," she said.The chaotic hearing saw Doherty, due at West London magistrates court for 9.30am, arrive shortly before midday.As he pushed his way through a throng of waiting photographers, the singer, wearing a dark suit, black shirt and trademark trilby hat, was heard to mumble that he was "a bit nervous about the hearing".Shortly beforehand, Ms Lachhar had issued a warrant for his arrest. "This is a court of law," the judge said. "He should have been here at 9.30am, and he isn't. I am giving a warrant with no bail."When the hearing eventually started, a seemingly emotional Doherty wept when he was told he could face a jail sentence and struggled to give his new address, eventually doing so through his lawyer. He pleaded guilty to charges of possessing quantities of crack cocaine, heroin, cannabis and ketamine - "quite a selection" of drugs, the judge said - and to two driving offences. He also admitted an extra charge of failing to appear in court without reasonable excuse. The court heard the drugs had been found either on Doherty's person or in his car after police stopped him in central London on May 5.Doherty's lawyer, Sean Curran, argued that the charges related to "small amounts" of drugs and that the singer had been working extremely hard on his new album at the time of his arrest. He added that it would be in the singer's best interests for him not to drive in future, prompting the judge to interrupt: "I am more concerned about the danger to other members of the public on the road and to pedestrians." She was equally dismissive when Mr Curran explained that Doherty's addiction was difficult to deal with because of his profession and the amount of media attention he faces."But he has a lot of days off. What about the people who work five days a week?" Ms Lachhar responded.Asked after the hearing whether he would abide by the judge's conditions, Doherty answered: "I've got no choice, have I?" "She said all options are considered, and that if I do not attend detox, I will go to jail. It's rehab or jail." A self-confessed drug addict, the singer has appeared before a series of London courts over the past few years. He has also made efforts to end his dependence on drugs. In April, district judge Jane McIvor praised Doherty's progress, saying the singer was "more than cooperating" with a court-mandated treatment programme.