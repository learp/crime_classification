Ed Miliband has launched a personal attack on David Cameron's handling of last week's riots, accusing the prime minister of being "shallow and simplistic".Reiterating his call for a national inquiry into the causes of the violence, he said the country had a "deep need" to explain and understand what had happened, but that Cameron had responded with "gimmickry".The Labour leader said nothing could excuse or justify the actions of the rioters and looters but that, unless the causes were understood properly, the violence could be repeated.Miliband was speaking at Haverstock school, the secondary school in north London that he attended. Neighbouring shops were looted last week.He addressed an audience of Labour party activists and local community members moments after Cameron concluded his own speech on the subject in his Witney constituency.Miliband said writing the riots off as "pure criminality" or simply blaming parents would not get to the root of the problem. In a direct attack on Cameron, he characterised the government's response as "kneejerk gimmicks", citing talk of water cannon, "supercops" and the "harassment" of gangs."A prime minister who used to say 'hug a hoodie' now says the answer is to reform our health and safety laws," he said."A crisis like this tells us something about our political leaders. Day by day, the prime minister has revealed himself to be reaching for shallow and superficial answers."Miliband said individuals were responsible for their actions, questioning why some parents were failing to teach their children right from wrong, but added that everyone had a responsibility for the society we live in.He also questioned whether an economy that dictates that some parents have to work up to 70-hour weeks, meaning they are largely absent from their children's lives, might have a role in family breakdown.But he added: "Children's ideas of right and wrong don't just come from their parents. And we can't honestly say the greed, selfishness and gross irresponsibility that shocked us all so deeply is confined to the looters, or even to their parents."It's not the first time we've seen this kind of me first, take what you can culture. The bankers who took millions while destroying people's savings – greedy, selfish and immoral. The MPs who fiddled their expenses – greedy, selfish and immoral. The people who hacked phones to get stories to make money for themselves – greedy, selfish and immoral."People who talk about the sick behaviour of those without power should talk equally about the sick behaviour of those with power."Let's not pretend that the crisis of values in our society is confined to a minority only at the bottom when we see the morality of millions of hardworking, decent people under siege from the top as well."He said the last Labour government, as well as the coalition, had failed to address the issues of inequality in society, arguing that there is a culture of aspiration for success that is out of the reach of people at the bottom, creating frustration.He called on Cameron to set up a commission of inquiry, with a mandate to listen to the nation's young people in particular, saying: "If he does not, I will."He said the commission should investigate why people looted and vandalised their own neighbourhoods and why they felt no loyalty to their own communities, and what had led to the "greed, selfishness, immorality" demonstrated last week.It should also look at the role parents played, the links between the economy and society and working pressures on families, and the role of the elite – politicians, press and bankers – in influencing cultural values.Miliband said that after other major riots in Brixton and Oldham, commissions had been set up."We cannot let these be the seven days in August which shook our nation, which our nation then forgot," he added.