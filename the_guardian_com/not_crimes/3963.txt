The New York attorney general is investigating whether ExxonMobil misled the public and investors about the dangers and potential business risks of climate change, sources familiar with the investigation said on Thursday.The company confirmed that it had received a subpoena from Eric Schneidermann, the New York attorney general, for financial records, email and other documents related to climate change.Peabody Energy, the world’s biggest private coal company, is also under investigation, the legal sources confirmed.The two giants of the fossil fuel industry – Exxon and Peabody – have long come under criticism from environmental and science groups for funding climate denial front groups, and spreading disinformation about climate science.Democratic presidential contenders Hillary Clinton and Bernie Sanders have both called for investigations into Exxon, following revelations that the company knew for decades about the dangers of climate change, but continued to cast doubt about the science.The oil company denied the allegations, and said it had been forthcoming about the business risks of climate change in its shareholder and other reports.“We unequivocally reject allegations that ExxonMobil suppressed climate change research contained in media reports that are inaccurate distortions of ExxonMobil’s nearly 40-year history of climate research that was conducted publicly in conjunction with the Department of Energy, academics and the UN Intergovernmental Panel on Climate Change,” Richard Keil, a spokesman, said in an emailed statement.In Exxon’s case, the investigation will focus on any inconsistencies between the company’s knowledge of climate change – from its own in-house team of scientists and other experts – and its filings to the Securities Exchange Commission and other government regulatory agencies, the sources said.“The fundamental question is whether they were misleading the public and investors by having financial reports inconsistent with what they knew to be the science,” the sources said. “It could include the funding of climate denial science. It could involve funding straight science that showed the impact of climate change.”The investigators could make use of a New York statute known as the Martin Act which, it is believed, would make it easier to secure a conviction than under financial regulations.The investigation, first reported by the New York Times, follows investigations by Inside Climate News and the Los Angeles Times which revealed the company for decades disregarded the findings of its own top-flight science.The Guardian reported last July that Exxon’s own scientists were aware as early as 1981 that climate change could spell trouble for the oil business – years before global warming become a broad public concern. The investigation by Inside Climate News pushed the clock on Exxon’s knowledge of climate change back even further to the 1970s.However, the company for years continued to cast doubt on whether climate change was occurring or was caused by the burning of fossil fuels.An investigation by Greenpeace found the company spent more than $30m spreading confusion about climate science before making a public commitment to end funding such front groups in 2008. However, Exxon continued to fund members of Congress who deny climate change such as Jim Inhofe, the Oklahoma Republican. In the case of Peabody Energy, the company first disclosed in its SEC filings that it was under investigation.The world’s largest privately held coal company, Peabody Energy has pushed back aggressively on efforts to fight climate change, claiming that fossil fuels were essential to ending global poverty.The World Bank and other major financial institutions reject such arguments.Last year, at the height of the Ebola crisis, the company even went so far as to suggest that expanding coal use would have helped stop the public health crisis.