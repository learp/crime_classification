Ministers are facing a legal challenge which could force them to plough millions of pounds into prison treatment programmes because inmates are reaching the end of their sentences but cannot be freed because they have been unable to attend compulsory courses that are a condition of their release.Two prisoners are suing the justice secretary, Lord Falconer, claiming that they are being arbitrarily detained in breach of the European Convention on Human Rights. They say overcrowding has meant they have not been able to access the programmes they need to persuade the parole board they have addressed their offending behaviour and are no longer a risk to the public.The logjam is thought to affect more than 1,000 prisoners serving indeterminate sentences for public protection (IPP), an initiative for violent and sex offenders introduced by David Blunkett when he was home secretary.The "lifer" prisons which offer the courses are seriously overcrowded, and many IPP prisoners are being held indefinitely in local prisons where they have no access to the programmes. This, in turn, adds to the overcrowding crisis because many inmates are being held long beyond their tariffs, the minimum term they must serve before the parole board can release them. More than 2,750 have been sentenced to IPPs, with a median tariff of only 30 months.The legal challenge will add to Lord Falconer's woes as ministers struggle to come up with short-term measures to alleviate the overcrowding engulfing prisons. Numbers hit a record 80,486 last week and ministers have been warned that the prisons and overspill police cells are on course to reach full capacity next week unless emergency measures are taken.The parole board, which has been overwhelmed by the extra workload, is facing a slew of cases by defendants whose hearings have been repeatedly delayed.A convicted sex offender, David Walker, claims he is being subjected to arbitrary detention in breach of his human rights because, six months away from the date he could apply for parole, he has not yet been assessed for a treatment programme. Until he completes the course, a process which takes about a year, his lawyers argue that he stands no chance of persuading the board he should be released.The high court hearing will also consider the case of a second IPP prisoner, Nicholas Wells. His case was initially against the parole board but the judge who heard it, Mr Justice Sullivan, decided that the responsible department - now the Ministry of Justice - should come to court to explain the delays in parole hearings.Walker's solicitor, John Dickinson, said: "Clearly the financial implications are substantial if we're successful. The whole system is absolutely collapsing. There is a long waiting list for courses, the parole board haven't got the funds to provide for the number of indeterminate sentence prisoners. The whole thing is a shambles, a disaster."Judges are obliged to sentence an offender to an IPP if he has committed one of 153 specified offences - some not particularly serious - and is deemed to be a significant risk of serious harm, physical or psychological, to members of the public. Critics of the law say it means giving an effective life sentence not for something an offender has done but for something he might do in future.The Home Office estimated that the new sentence would increase the prison population by 900 but 2,753 IPPs have been passed, with 28 new ones last week alone. Only five prisoners had been released from IPPs by April 2007, although many have been given short tariffs, some as little as 18 months.David Thomas QC, a retired Cambridge University don and author of the leading textbook on sentencing, said: "The root cause of the problem is that the government chose to make the dangerous offender provisions mandatory and to give the judges no discretion. If the government gave the judges discretion, the number of these sentences would fall dramatically."