The government is to offer a blank cheque to internet and phone firms that will be required to track everyone's email, Twitter, Facebook and other internet use under legislation to be published on Thursday.The Home Office has confirmed it will foot the bill, thought to run into tens and possibly hundreds of millions, for collecting and storing the extra social media and web browsing records needed to implement the scheme, which critics have dubbed an "online snooper's charter".Ministers did not put a figure on the cost of the new scheme but said it would be far less than the £2bn price tag estimated when Labour put forward a web-tracking scheme based on a central Home Office database in 2006.The Liberal Democrats are expected to scale back their criticism of the legislation, which is to be published in draft form on Thursday, after Nick Clegg's intervention secured a series of safeguards, including a scrutiny inquiry by MPs and peers that will report by the end of November.But the measure is expected to continue to attract fierce criticism from libertarian Conservatives, led by the former shadow home secretary David Davis, who this week attacked it again, calling it "expensive, unnecessary and a huge invasion of everyone's privacy".An online petition run by the campaign group 38 degrees has already attracted more than 163,000 signatures under the slogan: "Our civil liberties have taken a battering in recent years from politicians of all backgrounds. Now it's time to for us to push back."Tom Brake MP, co-chair of the Lib Dem home affairs committee, said the decision to publish the bill in draft meant there was now an opportunity to examine all its aspects before it was voted on in parliament.Brake said there was no objection in principle to extending the capability of the police and security services to access communications data from emails, texts and mobile phones to Twitter, Facebook and other new forms of social media. But the party wanted assurances that it was technically possible to access the "who sent what to whom, when and where" traffic data without accessing content – a point about which there is much debate.Brake said they wanted to see the list of state agencies who could not access such personal data without a warrant extended to cover bodies such as the Food Standards Agency.He said he also wanted to know what proportion of the 500,000 requests for communications data already made each year successfully contributed to investigations and whether it was possible to reduce the volume.The safeguards secured by Clegg include the joint scrutiny committee of MPs and peers, who will hear expert evidence, including that from the Home Office, and examine all aspects to ensure the measure is not "rammed through parliament". It has already been quietly agreed that the committee should report by the end of November, implying a timetable that could see the measure on the statute book within 12 months.It is also expected that inquiries into the bill will be mounted by parliament's intelligence and security and home affairs committees before it emerges in its final form.Other safeguards to be detailed in the draft bill are a "case-by-case" oversight by the interception of the communications surveillance commissioner, the publication of a privacy impact statement, and powers for the information commissioner to ensure the stored data is kept secure then destroyed when the 12-month retention period expires.Individuals who feel they have been subject to unlawful tracking will be able to complain to a panel of senior judges in the investigatory powers tribunal.It will also remain the case that the police and security services will not be allowed to access the content of emails, texts, mobile calls and other confidential web use, without a warrant signed by the home secretary.The communications data police and others may seek about an individual includes email addresses and phone numbers of people who have been in contact, when this happened, and where, the details giving the police records of suspects' associates and activities.Internet and phone companies are already required to give the police and security services access to the communications data they retain for their own billing and business purposes. But the Home Office states that the rapidly changing nature of the net, including the widespread use of social media that is not billed item by item, means that this power is no longer sufficient for tracking the activities of criminals online.Officials say that 25% of requests for communications data by the police and security agencies can no longer be met.The legislation to be published today will break new legal ground in requiring internet and phone companies to collect this new communications data and not just pass on data they already retain.